<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Shinobi by moeiscool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Shinobi</h1>
      <h2 class="project-tagline">Open Source CCTV software written in Node.JS ( IP Camera Recorder )</h2>
      <a href="https://github.com/moeiscool/Shinobi" class="btn">View on GitHub</a>
      <a href="https://github.com/moeiscool/Shinobi/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/moeiscool/Shinobi/tarball/master" class="btn">Download .tar.gz</a>
        <div style="margin:20px 0"></div>
<a class="btn" style="background:rgba(255,255,255,1);padding:10px;line-height: 1;" href='https://www.bountysource.com/teams/shinobi'><img src='https://d2bbtvgnhux6eq.cloudfront.net/assets/Bountysource-green-f2f437ed727ee2cacaee3f559c1907cb.png'></a> <a title="CAD" href='https://pledgie.com/campaigns/33051'><img alt='Click here to lend your support to: Shinobi, Open Source CCTV written in Node.js and make a donation at pledgie.com !' src='https://pledgie.com/campaigns/33051.png?skin_name=chrome' border='0' ></a>
    </section>

    <section class="main-content">
<div class="file-content wiki">
<h1 dir="auto">
<a id="shinobi" class="anchor" href="#shinobi" aria-hidden="true"></a>Shinobi</h1>

<p dir="auto">Shinobi is an Open Source CCTV software written in Node.JS. Designed with multiple account system, Streams by WebSocket, and Save to WebM. Currently it is being crafted for IP Cameras, not local.</p>

<p dir="auto"></p><div class="image-container"><a class="no-attachment-icon" href="https://github.com/moeiscool/Shinobi/blob/master/web/libs/img/demo.gif?raw=true" target="_blank" rel="nofollow noreferrer"><img src="https://github.com/moeiscool/Shinobi/blob/master/web/libs/img/demo.gif?raw=true"></a></div>

<h1 dir="auto">
<a id="why" class="anchor" href="#why" aria-hidden="true"></a>Why?</h1>

<ul dir="auto">
<li>
<p>MJPEG streams that are presented as a DOM element puts serious strain on the client browser when needing to be removed and added again. They cannot be terminated without a hard refresh of the page or use of popup or iframe. It essentially opens new streams everytime you recreate an image with an MJPEG url.</p>

<ul>
<li>Shinobi addresses this with <code>WebSocket</code> streams.</li>
</ul>
</li>
<li>
<p><s>Saving to WebM not JPEG frames or MP4 video. JPEG and MP4 are heavy. WebM is not.</s></p>

<ul>
<li>Now Saves to WebM and MP4, your choice. RTSP -&gt; MP4 uses very little CPU power but uses a lot of storage space. MP4 is still heavy.</li>
</ul>
</li>
<li><p>Written in Node.js, not PHP, Perl, and whatever languages you can remember.</p></li>
<li><p>ZoneMinder was the first choice but it proved unstable for the reasons mentioned. Also it has so many bugs and bounties many of them are just being left behind in the ocean of bug reports.</p></li>
</ul>

<h1 dir="auto">
<a id="info" class="anchor" href="#info" aria-hidden="true"></a>Info</h1>

<ul dir="auto">
<li>Written in a simple structure. <code>camera.js</code> and <code>web</code> folder.</li>
<li>Easy Install. (not as easy as apt-get install zoneminder yet though. See below)</li>
<li>Streams are <code>img</code> tags transferred through <code>WebSocket</code>.</li>
<li>Any websocket enabled browser can support the image stream (including mobile)</li>
<li>Can save to WebM or MP4</li>
<li>Calendar view for Events</li>
<li><p><code>child.js</code> Child node processing to load balance ffmpeg processes across multiple nodes. <em>Work in Progress, needs h264 added and schema update</em></p></li>
<li>
<p>Client-side Tested on : </p>

<ul>
<li>iPad Mini 2

<ul>
<li>Safari</li>
<li>Chrome</li>
</ul>
</li>
<li>iPhone 5

<ul>
<li>Safari</li>
<li>Chrome</li>
</ul>
</li>
<li>Windows 7

<ul>
<li>Chrome</li>
</ul>
</li>
<li>Mac OS Sierra

<ul>
<li>Safari</li>
<li>Chrome</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Server-side Tested on:</p>

<ul>
<li>Macbook (some old white one)

<ul>
<li>Ubuntu 16.04 (should work on any linux)</li>
</ul>
</li>
<li>Macbook (2013, i5, 16GB RAM)

<ul>
<li>Mac OS Sierra</li>
</ul>
</li>
</ul>
</li>
<li><p>If you have successfully run Shinobi on a system not listed (client or server). Please send me a PM so I can add it to the list.</p></li>
</ul>

<h1 dir="auto">
<a id="how-to-install-and-run" class="anchor" href="#how-to-install-and-run" aria-hidden="true"></a>How to Install and Run</h1>

<p dir="auto"><em>For a Test deployment enviroment I suggest grabbing an old MacBook (what I did) and installing Node.JS on there. Open up Terminal to get started.</em></p>

<p dir="auto"><b>VIDEO TUTORIAL :</b> <a href="https://www.youtube.com/watch?v=jfgUNfVEEEc" rel="nofollow noreferrer" target="_blank">https://www.youtube.com/watch?v=jfgUNfVEEEc</a></p>

<p dir="auto"><b>Dont have Node.js installed?</b></p>

<ol dir="auto">
<li>Open <code>Terminal</code>.</li>
<li>
<p>Install Node.js and it's package manager</p>

<ul>
<li>
<em>Note :</em> <code>#apt-get install node</code> installs something else, not Node.js.</li>
</ul>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>apt-get install nodejs npm
</code></pre>
</li>
<li>
<p>Create a symlink to use nodejs.</p>

<ul>
<li>pm2 needs this. If you don't plan on using pm2, then ignore this step.
<code>
ln -s /usr/bin/nodejs /usr/bin/node
</code>
</li>
</ul>
</li>
<li>
<p>Not on Ubuntu? Other operating systems can be found here.</p>

<ul>
<li><a href="https://nodejs.org/en/download/package-manager/" rel="nofollow noreferrer" target="_blank">https://nodejs.org/en/download/package-manager/</a></li>
</ul>
</li>
</ol>

<p dir="auto"><b>Dont have MySQL installed?</b></p>

<ol dir="auto">
<li>
<p>Open <code>Terminal</code>. Run :</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>apt-get install mysql-server
</code></pre>
</li>
<li><p>Installation of MySQL prompt you to set a password for <code>root</code> user in MySQL on your first install.</p></li>
</ol>

<ul dir="auto">
<li>Mac OS (will need more techiness ironically, follow this link) : <a href="https://blog.joefallon.net/2013/10/install-mysql-on-mac-osx-using-homebrew/" rel="nofollow noreferrer" target="_blank">https://blog.joefallon.net/2013/10/install-mysql-on-mac-osx-using-homebrew/</a> .</li>
</ul>

<p dir="auto"><b>Application Install</b></p>

<ol dir="auto">
<li><p>Open <code>Terminal</code>.</p></li>
<li>
<p>Download Shinobi with <code>wget</code> if you don't have <code>git</code> installed.</p>

<ul>
<li>Do this only if you haven't already downloaded the files.</li>
</ul>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>wget https://github.com/moeiscool/Shinobi/tarball/master
</code></pre>
</li>
<li>
<p>Untar the downloaded file. The extracted directory is the shinobi directory.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>tar -xzf master
</code></pre>
</li>
<li>
<p>Rename the directory for easier access. The extracted folder name will be different. <code>moeiscool-Shinobi-XXXXXXX</code> is only an example.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>mv moeiscool-Shinobi-XXXXXXX shinobi
</code></pre>
</li>
<li>
<p>Set permissions on the shinobi directory. <em>Where <code>camera.js</code> is located.</em></p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>chmod -R 755 shinobi
</code></pre>
</li>
<li>
<p>Open Shinobi directory.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>cd shinobi
</code></pre>

<p><b>Setup SQL</b></p>
</li>
<li>
<p>Go to <code>sql</code> and install the SQL files in your database.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>cd sql
</code></pre>
</li>
<li>
<p>Terminal SQL client can be accessed by running :</p>

<ul>
<li>The password will have been set during the installation of MySQL.</li>
</ul>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>mysql -u root -p
</code></pre>
</li>
<li>
<p><em>OPTIONAL :</em> Create New SQL User with privileges. If you choose to use your own pre-defined credentials skip this step.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>source ./user.sql
</code></pre>

<ul>
<li>or create your own</li>
</ul>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>CREATE USER 'majesticflame'@'127.0.0.1' IDENTIFIED BY '';
GRANT ALL PRIVILEGES ON * . * TO 'majesticflame'@'127.0.0.1';
FLUSH PRIVILEGES;
</code></pre>
</li>
<li>
<p>while still in the SQL client. Install the Shinobi database. It will create a database called <code>ccio</code>.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>source ./framework.sql
</code></pre>
</li>
<li>
<p><em>OPTIONAL :</em> <code>default_data.sql</code> contains a demo user and a demo <code>rtsp to mp4</code> monitor.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>source ./default_data.sql
</code></pre>
</li>
<li>
<p>After importing the data. Exit the sql client.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>exit
</code></pre>
</li>
<li>
<p>Go up one directory to enter the main directory. <em>Where <code>camera.js</code> is located.</em> </p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>cd ..
</code></pre>
</li>
<li>
<p>Edit <code>conf.json</code> to reflect your sql credentials. I don't reccommend using root.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>nano conf.json
</code></pre>

<ul>
<li>Contents of default <code>conf.json</code> file, located in the main directory.</li>
</ul>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>{"host":"127.0.0.1","user":"majesticflame","password":"","database":"ccio"}
</code></pre>

<p><b>Install Libraries</b></p>
</li>
<li>
<p>Run <code>npm install</code> while in the main directory. This will install the libraries Shinobi needs.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>npm install
</code></pre>

<p><b>Launch Shinobi</b></p>
</li>
<li>
<p>To start :</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>node camera.js
</code></pre>

<ul>
<li>If you did not make the symlink for nodejs then you must run <code>nodejs camera.js</code> instead.</li>
</ul>
</li>
<li>
<p>Open up <code>http://localhost</code> in your browser.</p>

<ul>
<li>If you inserted the <code>default_data.sql</code> login with <code>Username : ccio@m03.ca</code> and <code>Password : password</code>.</li>
<li>
<em>Note :</em> if you are installed on a remote computer open up the IP instead <code>http://111.111.111.111</code> in your browser.</li>
</ul>
</li>
</ol>

<p dir="auto"><b>Optional for some OS</b></p>

<ul dir="auto">
<li>
<p>Install dstat :</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>apt-get install dstat
</code></pre>

<ul>
<li>It's the CPU indicator, the orange progress bar on the web panel.</li>
<li>if you choose not to install or can't then it will just post an error in the log.</li>
<li>Sadly there is no dstat for Mac OS.</li>
</ul>
</li>
<li>
<p>To daemonize the process install pm2 with </p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>npm install pm2 -g
</code></pre>

<p>then to start : </p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>pm2 start camera.js
</code></pre>

<ul>
<li>run <code>pm2 logs</code> to see the console for any errors.</li>
<li>
<code>forever</code> is another program to daemonize, but i've had more success with <code>pm2</code>.</li>
</ul>
</li>
</ul>

<h1 dir="auto">
<a id="how-to-update" class="anchor" href="#how-to-update" aria-hidden="true"></a>How to Update</h1>

<ul dir="auto">
<li>Overwrite old files.</li>
</ul>

<p dir="auto"><code>SQL Database</code></p>

<ul dir="auto">
<li><p><em>Rare, please ensure that your structure is actually out of date before doing this.</em></p></li>
<li><p>Backup your SQL data.</p></li>
<li><p>Run <code>framework.sql</code> in your mysql client.</p></li>
</ul>

<h1 dir="auto">
<a id="to-do" class="anchor" href="#to-do" aria-hidden="true"></a>To Do</h1>

<ul dir="auto">
<li>Organize this README.</li>
<li>Fix Pipe error that occasionally occurs. <code>(appears to be caused by JPEG stream emit or pipe into ffmpeg, MJPEG is not affected)</code>
</li>
<li>better vieweing for saved events.</li>
<li>Save events with blank frames and force real duration instead of based on frame count.</li>
<li>better mobile support.</li>
<li>Find alternative to dstat that works on windows, mac, and linux for CPU indicator.</li>
</ul>

<h1 dir="auto">
<a id="donate" class="anchor" href="#donate" aria-hidden="true"></a>Donate</h1>

<p dir="auto">If you like what I am doing here and want me to continue please consider donating :)</p>

<p dir="auto"><a href="https://www.bountysource.com/teams/shinobi" rel="nofollow noreferrer" target="_blank"><img src="https://d2bbtvgnhux6eq.cloudfront.net/assets/Bountysource-green-f2f437ed727ee2cacaee3f559c1907cb.png"></a></p>

<h1 dir="auto">
<a id="author" class="anchor" href="#author" aria-hidden="true"></a>Author</h1>

<p dir="auto">Moe Alam, just a guy who needed CCTV</p>

<h1 dir="auto">
<a id="credits" class="anchor" href="#credits" aria-hidden="true"></a>Credits</h1>

<p dir="auto">If you wish to use this software for commercial purposes please consider donating :) If not.. including my name would be nice.</p>

<pre class="code highlight js-syntax-highlight plaintext monokai" v-pre="true"><code>Shinobi
Copyright (C) 2016-2025 Moe Alam, moeiscool

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

# Libraries Used

vbox.css (the framework that does the vertical panel layout) - I honestly don't know who made this, i found it in a zip.
jQuery - http://jquery.com/
Socket.io - http://socket.io/
Bootstrap - http://getbootstrap.com/
Moment.js - http://momentjs.com/
Livestamp.js - https://mattbradley.github.io/livestampjs/
Font Awesome - http://fontawesome.io/
Node.js - https://nodejs.org
MySQL - https://www.mysql.com/
NPM: mysql - https://www.npmjs.com/package/mysql
NPM: crypto - https://www.npmjs.com/package/crypto
NPM: express - http://expressjs.com/
NPM: request - https://www.npmjs.com/package/request
NPM: connection-tester - https://www.npmjs.com/package/connection-tester


and maybe a few others.
</code></pre>
</div>
<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
    this.page.url = location.origin;
    this.page.identifier = 'shinobicctv';
};
(function() {
var d = document, s = d.createElement('script');
s.src = '//shinobicctv.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
</section>  
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </body>
</html>